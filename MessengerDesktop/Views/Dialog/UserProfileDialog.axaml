<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:MessengerDesktop.ViewModels"
             xmlns:conv="using:MessengerDesktop.Converters"
             mc:Ignorable="d"
             d:DesignWidth="400"
             x:Class="MessengerDesktop.Views.UserProfileDialog"
             x:DataType="vm:UserProfileDialogViewModel">

	<Border Width="400"
            Background="{DynamicResource SecondaryBG}"
            CornerRadius="16"
			BorderThickness="1"
			BorderBrush="{DynamicResource BorderDefault}"
            BoxShadow="0 8 32 #50000000">

		<Grid RowDefinitions="Auto,*">

			<!-- ================= HEADER ================= -->
			<Border Background="{DynamicResource PrimaryBG}"
                    CornerRadius="12,12,0,0"
                    Padding="24,18">
				<TextBlock Text="Профиль пользователя"
                           FontSize="17"
                           FontWeight="SemiBold"
                           Foreground="{DynamicResource TextPrimary}"/>
			</Border>

			<!-- ================= CONTENT ================= -->
			<ScrollViewer Grid.Row="1"
                          VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled">
				<StackPanel Margin="24,20,24,24" Spacing="20">

					<!-- ===== БЛОК 1: Аватар и имя ===== -->
					<Grid ColumnDefinitions="Auto,*"
                          HorizontalAlignment="Stretch">

						<!-- Аватар слева -->
						<Border Width="64"
                                Height="64"
                                CornerRadius="32"
                                Background="#3A3A3A"
                                ClipToBounds="True"
                                BoxShadow="0 2 8 #30000000"
                                VerticalAlignment="Top"
                                Margin="0,0,16,0">
							<Image Source="{Binding AvatarBitmap}"
                                   Stretch="UniformToFill"/>
						</Border>

						<!-- Имя и статус справа -->
						<StackPanel Grid.Column="1"
                                    VerticalAlignment="Center"
                                    Spacing="2">
							<TextBlock Text="{Binding User.DisplayName}"
                                       FontSize="18"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimary}"
                                       TextWrapping="Wrap"/>

							<TextBlock Text="был(а) недавно"
                                       FontSize="13"
                                       Foreground="{DynamicResource TextSecondary}"/>
						</StackPanel>
					</Grid>

					<!-- Разделитель -->
					<Border Height="1" Background="{DynamicResource BorderDefault}"/>

					<!-- ===== БЛОК 2: Информация об аккаунте ===== -->
					<StackPanel Spacing="12">
						<TextBlock Text="ИНФОРМАЦИЯ"
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextSecondary}"
                                   Opacity="0.7"/>

						<!-- Username -->
						<Grid ColumnDefinitions="*,*">
							<TextBlock Text="Имя пользователя"
                                       FontSize="14"
                                       Foreground="{DynamicResource TextSecondary}"/>
							<TextBlock Grid.Column="1"
                                       Text="{Binding User.Username, StringFormat='@{0}'}"
                                       FontSize="14"
                                       Foreground="{DynamicResource TextPrimary}"
                                       HorizontalAlignment="Right"/>
						</Grid>

						<!-- Отдел -->
						<Grid ColumnDefinitions="*,*"
                              IsVisible="{Binding User.Department, Converter={x:Static ObjectConverters.IsNotNull}}">
							<TextBlock Text="Отдел"
                                       FontSize="14"
                                       Foreground="{DynamicResource TextSecondary}"/>
							<TextBlock Grid.Column="1"
                                       Text="{Binding User.Department}"
                                       FontSize="14"
                                       Foreground="{DynamicResource TextPrimary}"
                                       HorizontalAlignment="Right"
                                       TextTrimming="CharacterEllipsis"/>
						</Grid>
					</StackPanel>

					<!-- Разделитель -->
					<Border Height="1" Background="{DynamicResource BorderDefault}"/>

					<!-- ===== БЛОК 3: Контактная информация ===== -->
					<StackPanel Spacing="12">
						<TextBlock Text="КОНТАКТЫ"
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextSecondary}"
                                   Opacity="0.7"/>

						<TextBlock Text="Контактная информация не указана"
                                   FontSize="13"
                                   Foreground="{DynamicResource TextSecondary}"
                                   FontStyle="Italic"/>
					</StackPanel>

					<!-- Разделитель -->
					<Border Height="1" Background="{DynamicResource BorderDefault}"/>

					<!-- ===== БЛОК 4: Быстрое сообщение ===== -->
					<StackPanel Spacing="12">
						<TextBlock Text="НАПИСАТЬ СООБЩЕНИЕ"
                                   FontSize="12"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource TextSecondary}"
                                   Opacity="0.7"/>

						<TextBox Text="{Binding Message}"
                                 AcceptsReturn="True"
                                 TextWrapping="Wrap"
                                 MinHeight="70"
                                 MaxHeight="140"
                                 Watermark="Введите сообщение..."
                                 Background="{DynamicResource PrimaryBG}"
                                 BorderBrush="{DynamicResource BorderDefault}"
                                 BorderThickness="1"
                                 CornerRadius="8"
                                 Padding="12,10"/>

						<Button Content="Отправить"
                                HorizontalAlignment="Right"
                                Command="{Binding SendMessageCommand}"
                                Classes="AccentButton"
                                Padding="20,10"
                                CornerRadius="8"/>
					</StackPanel>

				</StackPanel>
			</ScrollViewer>

		</Grid>
	</Border>
</UserControl>